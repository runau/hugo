---
title: "超初心者向け dynamoDBのテーブルの作り方"
date: 2020-03-07T23:28:23+09:00
meta_image: "posts/meta_image/20200307_night.png"
tags: 
    - aws
    - dynamoDB
categories: 
    - 解説
---

dynamoDBってすごい安くて、なれるとなかなか使いやすくて、速度も早くて、いいんですが、初心者にはちょっと難しいところもあって…

でも使って欲しいので、初心者用の記事を書いてみます。

## 料金

dynamoDBってすっごい安いんですよ。

[お昼の検証](../20200307_lunch/)でも書きましたが、getリクエスト:0.00285USD/1万、putリクエスト:0.014269USD/1万しかかかりません。

ちょっと安すぎて意味が分かんないww

1万回にinsertをして1円って事です。

[公式の料金ページ](https://aws.amazon.com/jp/dynamodb/pricing/on-demand/)

![dynamo料金](../img/pricing-dynamo.png)

ただ、設定を間違えると、ちょっとお金がかかります…。

私もこれから書く部分の間違いで3000円くらい取られてしまいました…ショック…

## 作り方

### 作り方①　1万回リクエストで1円

dynamoDBを開いて、テーブルの作成を押します。

![テーブル作成](../img/dynamo-create0.png)

必須項目はテーブル名とプライマリーキーのみです。

まず、この二つを入力します。

で、デフォルトの設定の使用のチェックを外します。

ここを外さないと、**すごいお金がかかってしまう可能性**があります！

![テーブル作成](../img/dynamo-create.png)

チェックを外すと↓のようなキャパシティーの詳細設定が出てきます。

キャパシティーという、dynamoDBの頭脳をどれだけ使うかという設定です。

↑で説明した、1万回にinsertをして1円という設定のためには、以下のように**オンデマンドにチェック**をつけて作成します。

![テーブル作成](../img/dynamo-create2.png)

そうすると、従量課金制。使った分だけ、請求されます。

しかし、さっきのチェックボックスのところを見ると、プロビジョニングに(無料使用枠の対象)ってかいてありますね。

つい、こっちを選びたくなりますww

こっちを選ぶなら↓のように設定していただく必要があります。

### 作り方②　無料使用枠の利用

プロビジョニングのテーブルの作り方です。

これは危険で、私が3000円無駄にしたのはこのプロビジョニングのテーブルでした…。

ちょっと考えることも多く、めんどうなので、どうしても無料にしたい！って思いがない初心者の方は、**作り方①のオンデマンドをおすすめ**します。

↓のようなキャパシティーの詳細設定ですが、プロビジョニング(無料使用枠の対象)にチェックが付いていますね。

![テーブル作成](../img/dynamo-create1.png)

この無料使用枠には限度があります。

**月に25ユニットまで**です。

このままにしてしまうと、5～40000ユニットの間でオートスケーリング、つまり5ユニットで頭脳が足りなくなると、**最大40000ユニットまで勝手に使用ユニット数を上げてしまいます**…。

25ユニットまで無料なので、間違えて無限ループとかの負荷を書けてしまうと使用ユニットが増えて、お金がかかります…。

なので、業務で使うわけでないなら、まずオートスケーリングのチェックを外します。

で、その上のユニットの指定数を必要に応じて下げます。

全テーブルの合計が25ユニットまで無料なので、合計が25以下になるように調整してください。

![テーブル作成](../img/dynamo-create2.png)

テーブル作成後、dynamoDBのダッシュボードで全前テーブルの総キャパシティー(合計ユニット)が25以下になっていることを確認して下さい。

**ここが25より大きいと**、お金がかかります！

![テーブル作成](../img/dynamo-create5.png)

また、プロビジョニングにすると、必要に応じて、cloudWatchのアラームが自動で作成されます。

これがちょっとした罠で…。

cloudWatchアラームは10個までは無料で、それ以降は1アラーム月0.10USDかかります。

[公式の料金ページ](https://aws.amazon.com/jp/cloudwatch/pricing/)

↓のようにcloudWatchのサイドバーで確認できます。

![テーブル作成](../img/dynamo-create4.png)

数字の合計が10以下なら問題ありません。

11以上になってしまっていたら、クリックして、不要なものを削除してください。

何が不要か分からなかったら、どれを消しても大丈夫です。

## 独り言

くだくだになってしまった…。

分かんねーよってなったら[質問箱](https://encr.jp/q/)に質問頂けたら動い嬉しいです//

