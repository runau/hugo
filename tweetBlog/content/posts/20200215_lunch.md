---
title: "Twitterカードの画像の自動生成機能を考える　twitterカード画像自動生成機能②"
date: 2020-02-15T19:00:55+09:00
meta_image: "posts/meta_image/20200215_lunch.png"
tags: ["Python"]
categories: ["twitterカード画像自動生成機能"]
---

朝の続き。

朝活の後、カラオケオフ会に行ってきましたよw

うん、やっぱり楽しい！

歌、上手くなりたいなー…

さて、twitterカードの画像を自動生成したいというお話。

### 完成イメージの方針

大きく二つ
* スクショを取る
* 画像を作成する

どっちでもいいから、楽な方にしたいんだけど…

とりあえず両方考える！

#### スクショを撮る

こんな感じ
![完成イメージ](../img/twitter-card-after-image.jpg)

ブログの画面をスクショして、画像にして、それをカードに設定したい！

pythonでライブラリあるみたいだから、動的サイトのスクレイピングの要領で、画面表示して、スクショ取ればいいみたい！

できそう！だけど、lambdaでやるのは現実出来ではないかな…

ま、スクレイピング環境も作りたいから、合わせてecrで対応するのとかもよさげだけど…

いったんやめよう

#### 画像を作成する

こんな感じ
![Qiitaサンプル](../img/twitter-card-qitta.jpg)


キータはね、分かりやすいし可愛いよね

こういうの作りたい！

Qiitaは [imgix](https://www.imgix.com/)

ここでなんかしているらしい…

でもね、これ、月額10ドルから…

諦めよう…ww

でも、なんでもよければ、実は前にワードプレスで作ったんだよね。

アイキャッチ自動生成ツール

もう、記事ごとのアイキャッチ設定するのが本当にめんどうだったから、記事投稿時に、タイトルとカテゴリから勝手にアイキャッチ作ってくれるの作ったの

あれと同じ感じで作れるはず。

canvasに描画⇒pngに変換

画像が作れれば何でもいいんだけれど、全く知らない技術より、一回やったことあるものの方が工数削減のはず！

とりあえず、この方針で勧める。

#### ということで

画像作成の方向で…

### タイミング

ワードプレスの時は記事保存時に動かしてたんだけど、今回はどうしたもんか…

* 記事書いた後、build前にローカルでshかなんかで作って埋め込む

* build時に絡める

* build後にローカルでshかなんかで作って埋め込む

* s3put時にputイベントで作る

* html読み込んだ時に作る？できるのか？

うむ。

build時に絡めるは一番綺麗だろうけど、私には無理そうだから…

s3put時にputイベントもなかなか楽しそうだけど…。

でも一番楽なのは、ビルド前に何か動かすかな。

とりあえず、その方向で考える

### 何を作るか？

* 全記事を取得⇒画像がなかったら画像作成

* ビルド時にmetaタグにそれぞれの画像を設定

metaタグは、ビルド時に生成されるから、なんとかいい感じの参照をしてくれるようにしないと。

まずそこから試そう！

### metaタグを記事ごとに設定

今は、twitterカードの画像は、params.tomlで設定されてて、全記事共通の画像しか参照できない。

ここを変える方法を考える。

とりあえずmetaタグを設定しているmeta.htmlを眺める。

………。

うーん、goさっぱり分らん…。

goの勉強から始めなきゃダメなのか…？？

で、よく分かんないけど、アイキャッチって記事ごとに設定したいもんだし、とりあえず記事のヘッダーに追加してみたw

```20200215_lunch.md
---
title: "Twitterカードの画像の自動生成機能を考える"
date: 2020-02-15T19:00:55+09:00
meta_image: "meta_image/20200215_lunch.png"
---
```

そしたらいい感じにできたw

わーい//

そりゃそうだよね。記事ごとに設定しないといけないもんね。

記事のヘッダーは、params.tomlを上書きする設定ってイメージなのかね。

### 最後に

いや、ほんと

マークダウンでブログが書けるって素晴らしさねw

同じ記事量でも、ワードプレスの時はもっと時間かかってたわー

毎日3記事upとか、マークダウンだからこそ、できる技ですなwww

次の記事で自動生成作る！